@model PetalOrSomething.Models.FlowerInventory

@{
	ViewData["Title"] = "ProductView";
}

<div class="container">
	<div class="product-row">
		<div class="col-md-6 mb-4 mb-md-0">
			<h2 class="product-title text-primary fw-bold"
				style="font-size: 3rem !important; color: #5f4b8b !important">
				@Model.Name
			</h2>
			<p class="product-description text-muted" style="font-size: 0.85rem">
				@Model.Description
			</p>

			<div class="rating mb-1">
				@for (int i = 0; i < 5; i++)
				{
					if (i < Model.Rating)
					{
						<i class="fas fa-star text-warning"></i>
					}
					else
					{
						<i class="far fa-star text-warning"></i>
					}
				}
			</div>

			<div class="price-container mb-2">
				<span class="product-price fw-bold" style="font-size: 2rem; color: #FF45A2 !important;">
					₱@Model.Price
				</span>
			</div>

			<div class="product-options mb-4">
				<label for="quantity" class="d-block text-muted" style="font-size: 0.85rem">Quantity:</label>
				<input type="number" id="quantity" name="quantity" value="1" min="1" max="10"
					class="form-control w-auto" />
			</div>

			<div class="note-to-seller mt-4 mb-3">
				<label for="note" class="form-label" style="font-size: 0.85rem">Note to Seller:</label>
				<textarea id="note" rows="4" class="form-control"
					placeholder="Enter your message to the seller here..."></textarea>
			</div>

			<div class="button-group mb-4">
				<button class="btn custom-btn btn-lg me-2"
					onclick="addToCart(@Model.Id, '@Model.Name', @Model.Price, document.getElementById('quantity').value, '@Model.Model2DLink')">
					Add to Cart
				</button>
				<button class="btn custom-btn btn-lg me-2">Buy Now</button>
				<a class="btn custom-btn btn-lg me-2" asp-controller="Home" asp-action="Index">CUSTOMIZE</a>
			</div>
		</div>

		<div class="col-md-6 position-relative" style="height: 400px;">
			<model-viewer style="width: 100%; height: 100%; object-fit: contain;" src="@Model.Model3DLink"
				alt="3D Product" class="card-img-top" auto-rotate camera-controls background-color="#FFFFFF">
			</model-viewer>
		</div>
	</div>
</div>

<script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>
<script>
	function addToCart(productId, productName, price, quantity, image) {
		const cartItem = {
			ProductId: productId,
			ProductName: productName,
			Price: parseFloat(price),
			Quantity: parseInt(quantity),
			Image: image
		};

		$.ajax({
			url: '@Url.Action("AddItem", "Home")',
			type: 'POST',
			contentType: 'application/json',
			data: JSON.stringify(cartItem),
			success: function () {
				alert("Item added to cart!");
			},
			error: function (xhr, status, error) {
				alert("Failed to add item to cart.");
			}
		});
	}
</script>
